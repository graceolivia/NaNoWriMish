<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>november writing tracker — fiction + substack</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@300;400;600;700&display=swap');
    :root{
      --bg:#000000; --panel:#001100; --muted:#00ff00; --text:#00ff00; --acc:#00ff41; --ok:#00ff00; --warn:#44ff00; --danger:#ff4400;
      --radius:8px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font:16px/1.5 'Source Code Pro', 'Courier New', monospace; background:var(--bg); color:var(--text); text-shadow: 0 0 2px currentColor;}
    a{color:var(--acc)}
    .wrap{max-width:1050px;margin:24px auto;padding:0 16px 64px}
    header{display:flex;gap:18px;align-items:center;justify-content:space-between;margin:20px 0 8px}
    h1{font-size:clamp(22px,2.4vw,30px);margin:0}
    .subtitle{color:var(--muted);font-size:13px}
    .grid{display:grid;gap:16px}
    @media(min-width:900px){.grid{grid-template-columns:1.2fr .8fr}}
    .card{background:linear-gradient(180deg, rgba(0,255,0,0.05), rgba(0,255,0,0.02));border:1px solid #00ff00;border-radius:var(--radius);padding:16px 16px 18px;box-shadow:0 0 10px rgba(0,255,0,.3)}
    .card h2{margin:0 0 8px;font-size:18px}
    .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .muted{color:var(--muted)}
    .pill{display:inline-flex;align-items:center;gap:8px;border-radius:999px;padding:6px 10px;background:#001100;border:1px solid #00ff00;font-size:12px}
    .bar{height:18px;border-radius:999px;background:#001100;border:1px solid #00ff00;overflow:hidden;position:relative}
    .bar > span{display:block;height:100%;background:linear-gradient(90deg, #00ff00, #44ff44);width:0%}
    .kpi{display:flex;gap:16px;flex-wrap:wrap;margin-top:8px}
    .kpi .box{background:#001100;border:1px solid #00ff00;border-radius:12px;padding:10px 12px;min-width:120px}
    .kpi .big{font-weight:700;font-variant-numeric:tabular-nums}
    label{font-size:13px;color:var(--muted)}
    input[type="text"], input[type="number"], input[type="date"], textarea{width:100%;padding:10px 12px;border-radius:12px;border:1px solid #00ff00;background:#001100;color:var(--text);}
    textarea{min-height:72px}
    button{cursor:pointer;border:1px solid #00ff00;background:#001100;color:var(--text);padding:10px 14px;border-radius:12px}
    button.primary{background:linear-gradient(180deg,#002200,#001100);border-color:#00ff00}
    button.ghost{background:transparent;border-color:#00ff00}
    button.ok{background:#002200;border-color:#00ff00;color:#00ff00}
    button.warn{background:#002200;border-color:#44ff00;color:#44ff00}
    button.danger{background:#220000;border-color:#ff4400;color:#ff4400}
    table{width:100%;border-collapse:collapse;border-spacing:0}
    th,td{padding:8px 10px;border-bottom:1px dashed #00ff00;vertical-align:top}
    th{color:var(--muted);text-align:left;font-weight:600}
    tr:last-child td{border-bottom:none}
    .right{text-align:right}
    .small{font-size:12px}
    .split{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .vis-hide{display:none}
    .footer{margin-top:24px;color:var(--muted);font-size:12px}
    .checkbox-row{display:flex;gap:10px;align-items:center}
    .essay{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center;padding:8px;border-radius:12px;border:1px solid #00ff00;background:#001100}
    .essay input[type="text"]{height:36px}
    .essay.published{background:linear-gradient(180deg,#002200,#001100);opacity:.95}
    .badge{font-size:11px;padding:4px 8px;border-radius:999px;border:1px solid #00ff00;background:#001100;color:var(--muted)}
    details{border:1px solid #00ff00;background:#001100;border-radius:12px;padding:8px 10px}
    details > summary{cursor:pointer;color:var(--muted)}
    .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
    .status-badge{font-size:12px;padding:4px 8px;border-radius:999px;border:1px solid;margin-left:8px;font-weight:normal}
    .status-on-track{background:#002200;border-color:#00ff00;color:#00ff00}
    .status-ahead{background:#002200;border-color:#44ff00;color:#44ff00}
    .status-behind{background:#220000;border-color:#ff4400;color:#ff4400}
    .status-win{background:#004400;border-color:#00ff00;color:#00ff00;font-weight:bold}
    .status-fail{background:#440000;border-color:#ff4400;color:#ff4400;font-weight:bold}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>november writing tracker</h1>
        <div class="subtitle">fiction (target 25,000 words) + substack (4 essays) - due by December 1st</div>
        <div class="muted small" style="margin-top:4px">Today: <span id="currentDate"></span> | Challenge starts: Nov 1, 2025 | Deadline: Dec 1, 2025</div>
      </div>
    </header>

    <div class="grid">
      <!-- LEFT COLUMN: FICTION -->
      <section class="card" id="fictionCard">
        <h2>fiction progress <span id="fictionStatus" class="status-badge"></span></h2>
        <div class="bar" aria-label="fiction progress">
          <span id="fictionBar"></span>
        </div>
        <div class="kpi">
          <div class="box"><div class="muted small">total words</div><div class="big" id="fictionTotal">0</div></div>
          <div class="box"><div class="muted small">target</div><div class="big" id="fictionTarget">25000</div></div>
          <div class="box"><div class="muted small">completion</div><div class="big" id="fictionPct">0%</div></div>
          <div class="box"><div class="muted small">sessions</div><div class="big" id="sessionCount">0</div></div>
        </div>


        <div style="height:12px"></div>
        <table id="sessionTable">
          <thead>
            <tr><th style="width:120px">date</th><th class="right" style="width:90px">words</th><th>note</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>

      <!-- RIGHT COLUMN: ESSAYS & SETTINGS -->
      <section class="card">
        <h2>substack goals <span id="essayStatus" class="status-badge"></span></h2>
        <div class="row"><div class="badge"><span id="essayCount">0</span>/4 done</div></div>
        <div style="height:8px"></div>
        <div id="essays"></div>
      </section>
    </div>

    <div class="footer">a custom page to keep me on track for this writing challenge.</div>
  </div>

  <script>
    // --- hardcoded state ---
    const KEY = 'nano-2025-tracker-v1';
    const el = s => document.querySelector(s);
    const els = s => Array.from(document.querySelectorAll(s));
    
    // HARDCODED PROGRESS DATA - EDIT THESE VALUES
    const state = {
      targetWords: 25000,
      targetEssays: 4,
      sessions: [
        // Add your writing sessions here
        // Example: {id: 'sess1', date: '2024-11-01', words: 1200, note: 'Your notes here'}
        {date: '2025-11-01', words: 1143, note: 'wrote a short flashback preamble that introduced the main character and her sister'},
        {date: '2025-11-02', words: 1627, note: 'wrote chapter 2, introduced mysterious woods guy and ominous warnings'}
      ],
      essays: [
        {id: 'essay1', title: '', done: false},
        {id: 'essay2', title: '', done: false},
        {id: 'essay3', title: '', done: false},
        {id: 'essay4', title: '', done: false}
      ]
    };

    // load state (now uses hardcoded data)
    function load(){
      // State is now hardcoded above - no localStorage loading needed
      console.log('Using hardcoded progress data');
    }

    function save(){ 
      // Save function disabled - data is hardcoded
      console.log('Save disabled - using hardcoded data');
    }

    function uid(){ return Math.random().toString(36).slice(2,10); }

    // --- renderers ---
    function fmt(n){ return (n||0).toLocaleString(); }

    function renderSessions(){
      const tbody = el('#sessionTable tbody');
      tbody.innerHTML = '';
      state.sessions.sort((a,b)=> (a.date||'').localeCompare(b.date));
      for(const s of state.sessions){
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${s.date||''}</td>
          <td class="right">${fmt(s.words||0)}</td>
          <td>${s.note? escapeHTML(s.note) : '<span class="muted">—</span>'}</td>`;
        tbody.appendChild(tr);
      }

      const total = state.sessions.reduce((a,b)=>a + (+b.words||0), 0);
      el('#fictionTotal').textContent = fmt(total);
      el('#sessionCount').textContent = state.sessions.length;
      const target = +state.targetWords||25000;
      el('#fictionTarget').textContent = fmt(target);
      const pct = Math.min(100, Math.round((total/target)*100));
      el('#fictionPct').textContent = pct + '%';
      el('#fictionBar').style.width = pct + '%';
    }

    function renderEssays(){
      const box = el('#essays');
      box.innerHTML = '';
      let done = 0;
      for(const e of state.essays){ if(e.done) done++; }
      el('#essayCount').textContent = done;

      state.essays.forEach((e, idx)=>{
        const row = document.createElement('div');
        row.className = 'essay' + (e.done? ' published' : '');
        row.innerHTML = `
          <span style="width:20px;text-align:center;display:inline-block">${e.done? '✓' : '○'}</span>
          <span style="flex:1">${e.title || 'untitled essay'}</span>
          <span class="badge">${e.done? 'done' : 'pending'}</span>
        `;
        box.appendChild(row);
      });
    }


    function calculateStatus(){
      const now = new Date();
      const startDate = new Date('2025-11-01'); // November 1st start
      const endDate = new Date('2025-12-01');   // December 1st deadline
      
      // Debug: log the dates
      console.log('Current date:', now.toDateString());
      console.log('Start date:', startDate.toDateString());
      console.log('End date:', endDate.toDateString());
      console.log('Now >= endDate?', now >= endDate);
      console.log('Now < startDate?', now < startDate);
      
      const totalWords = state.sessions.reduce((a,b) => a + (+b.words||0), 0);
      const essaysCompleted = state.essays.filter(e => e.done).length;
      
      // Check if challenge is complete (December 1st or later)
      if (now >= endDate) {
        // Final results - WIN or FAIL
        const fictionBadge = el('#fictionStatus');
        if (totalWords >= 25000) {
          fictionBadge.textContent = `WIN (${totalWords.toLocaleString()} words)`;
          fictionBadge.className = 'status-badge status-win';
        } else {
          fictionBadge.textContent = `FAIL (${totalWords.toLocaleString()}/25,000)`;
          fictionBadge.className = 'status-badge status-fail';
        }
        
        const essayBadge = el('#essayStatus');
        if (essaysCompleted >= 4) {
          essayBadge.textContent = `WIN (${essaysCompleted}/4 essays)`;
          essayBadge.className = 'status-badge status-win';
        } else {
          essayBadge.textContent = `FAIL (${essaysCompleted}/4 essays)`;
          essayBadge.className = 'status-badge status-fail';
        }
        return;
      }
      
      // Check if challenge hasn't started yet
      if (now < startDate) {
        const fictionBadge = el('#fictionStatus');
        fictionBadge.textContent = 'not started yet';
        fictionBadge.className = 'status-badge status-on-track';
        
        const essayBadge = el('#essayStatus');
        essayBadge.textContent = 'not started yet';
        essayBadge.className = 'status-badge status-on-track';
        return;
      }
      
      // Calculate days elapsed since start (only count if started)
      const daysElapsed = Math.max(0, Math.floor((now - startDate) / (1000 * 60 * 60 * 24)));
      
      // Fiction status (834 words per day target)
      const targetWords = daysElapsed * 834;
      
      let fictionStatus = 'on track';
      let fictionClass = 'status-on-track';
      
      if (daysElapsed === 0) {
        // First day - just check if any progress made
        fictionStatus = totalWords > 0 ? 'started' : 'on track';
      } else if (totalWords > targetWords * 1.1) {
        fictionStatus = 'ahead';
        fictionClass = 'status-ahead';
      } else if (totalWords < targetWords * 0.9) {
        fictionStatus = 'behind';
        fictionClass = 'status-behind';
      }
      
      // Essay status (1 essay every 7 days)
      const targetEssays = Math.floor(daysElapsed / 7);
      
      let essayStatus = 'on track';
      let essayClass = 'status-on-track';
      
      if (daysElapsed < 7) {
        // First week - no essays due yet
        essayStatus = essaysCompleted > 0 ? 'ahead' : 'on track';
        essayClass = essaysCompleted > 0 ? 'status-ahead' : 'status-on-track';
      } else if (essaysCompleted > targetEssays) {
        essayStatus = 'ahead';
        essayClass = 'status-ahead';
      } else if (essaysCompleted < targetEssays) {
        essayStatus = 'behind';
        essayClass = 'status-behind';
      }
      
      // Update UI
      const fictionBadge = el('#fictionStatus');
      fictionBadge.textContent = fictionStatus;
      fictionBadge.className = `status-badge ${fictionClass}`;
      
      const essayBadge = el('#essayStatus');
      essayBadge.textContent = essayStatus;
      essayBadge.className = `status-badge ${essayClass}`;
    }

    function displayCurrentDate(){
      const now = new Date();
      const options = { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      };
      el('#currentDate').textContent = now.toLocaleDateString('en-US', options);
    }

    function update(){
      displayCurrentDate();
      renderSessions();
      renderEssays();
      calculateStatus();
    }


    // --- helpers ---
    function escapeHTML(s=''){ return s.replace(/[&<>]/g, c=> ({'&':'&amp;','<':'&lt;','>':'&gt;'}[c]) ); }
    function escapeAttr(s=''){ return s.replace(/[&<>\"]/g, c=> ({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;'}[c]) ); }

    // --- initial boot ---
    function boot(){
      load();
      // State is already populated with hardcoded data
      update();
    }

    document.addEventListener('DOMContentLoaded', boot);
  </script>
</body>
</html>